<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Apple Touch Icon for iOS Home Screen -->
    <link rel="apple-touch-icon" sizes="180x180" href="/nexus-logo-modern.svg">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>NEXUS AI | Multi-Model Intelligence</title>
  <meta name="description" content="Professional AI routing to GPT-4, Claude, and Gemini.">
  
  <!-- PWA & Mobile Readiness -->
  <link rel="icon" type="image/svg+xml" href="/nexus-logo-modern.svg">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0d0d0d">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Nexus AI">
  
  <!-- Preconnect to critical origins for faster resource loading -->
  <link rel="preconnect" href="https://esm.sh" crossorigin>
  <link rel="dns-prefetch" href="https://esm.sh">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Preload critical font to prevent FOUT/CLS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

  <!-- Tailwind: load async to unblock rendering (fixes LCP) -->
  <!-- Tailwind CSS is bundled via PostCSS in production. Remove CDN. -->
  <link rel="stylesheet" href="/dist/output.css">
  <style>
    :root {
      --bg-primary: #171717;
      --bg-secondary: #0d0d0d;
      --bg-tertiary: #212121;
      --text-primary: #d4d4d8; 
      --text-secondary: #a1a1aa;
      --border: rgba(255, 255, 255, 0.08);
      --accent: #10a37f;
      --header-bg: rgba(23, 23, 23, 0.85);
      --highlight: #f4f4f5;
      --code-bg: #0a0a0a;
      --code-header: rgba(255, 255, 255, 0.03);
      --tooltip-bg: #1a1a1a;
      --tooltip-text: #ffffff;
    }

    [data-theme='light'] {
      --bg-primary: #ffffff;
      --bg-secondary: #f9f9fb;
      --bg-tertiary: #f0f0f3;
      --text-primary: #1a1a1a;
      --text-secondary: #4b5563;
      --border: #e5e7eb;
      --highlight: #111827;
      --accent: #059669;
      --header-bg: rgba(255, 255, 255, 0.9);
      --code-bg: #f3f4f6;
      --code-header: #e5e7eb;
      --tooltip-bg: #111827;
      --tooltip-text: #ffffff;
    }

    body {
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 0;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      font-size: 16px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
        /* overscroll-behavior: none is not supported on iOS < 16, but safe for modern browsers */
        overscroll-behavior: none;
      height: 100vh;
      height: 100dvh;
      width: 100vw;
      max-width: 100%;
      /* Fix: Prevent all horizontal and vertical scrolling at the document level */
      overflow: hidden;
      -webkit-touch-callout: none;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    #root {
      height: 100vh;
      height: 100dvh;
      width: 100vw;
      max-width: 100%;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* CLS fix: reserve space for the main layout immediately */
      contain: layout style;
    }

    /* CLS fix: prevent layout shift from auth spinner */
    #root:empty {
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-primary);
    }
    #root:empty::after {
      content: '';
      width: 40px;
      height: 40px;
      border: 3px solid rgba(16, 163, 127, 0.2);
      border-top-color: #10a37f;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Professional Nexus Tooltip System */
    [data-nexus-tooltip] {
      position: relative;
    }
    [data-nexus-tooltip]::after {
      content: attr(data-nexus-tooltip);
      position: absolute;
      top: 100%;
      margin-top: 4px;
      left: 50%;
      transform: translateX(-50%) translateY(-3px);
      background: var(--tooltip-bg);
      color: var(--tooltip-text);
      padding: 3px 8px;
      border-radius: 6px;
      font-size: 9px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      white-space: nowrap;
      box-shadow: 0 4px 12px -2px rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.08);
      opacity: 0;
      pointer-events: none;
      transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1000;
    }
    [data-nexus-tooltip]:hover::after {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    .markdown-body {
      -webkit-user-select: text;
      user-select: text;
      min-width: 0;
      max-width: 100%;
      overflow-x: hidden;
    }

    .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
    .pt-safe { padding-top: env(safe-area-inset-top); }

    .markdown-body {
      line-height: 1.6;
      font-size: 1rem;
      letter-spacing: -0.01em;
      word-break: break-word;
      overflow-wrap: break-word;
    }

    @media (max-width: 640px) {
      .markdown-body {
        font-size: 0.9375rem;
        line-height: 1.55;
      }
    }

    .markdown-body p, .markdown-body > div { margin-bottom: 1rem; }

    .markdown-body h1, .markdown-body h2, .markdown-body h3 {
      font-weight: 700;
      color: var(--highlight);
      margin-top: 2rem;
      margin-bottom: 1rem;
      letter-spacing: -0.025em;
    }

    .markdown-body h1 { font-size: 1.25rem; }
    .markdown-body h2 { font-size: 1.125rem; }
    .markdown-body h3 { font-size: 1rem; }

    @media (max-width: 640px) {
      .markdown-body h1 { font-size: 1.125rem; }
      .markdown-body h2 { font-size: 1.0625rem; }
      .markdown-body h3 { font-size: 0.9375rem; }
    }

    .markdown-body ul, .markdown-body ol {
      padding-left: 1.5rem;
      margin-bottom: 1.25rem;
    }

    .markdown-body li {
      margin-bottom: 0.35rem;
      line-height: 1.6;
    }

    .markdown-body strong { color: var(--highlight); }

    .markdown-body blockquote {
      border-left: 3px solid var(--accent);
      padding-left: 1rem;
      margin: 1.5rem 0;
      color: var(--text-secondary);
      font-style: italic;
      background: var(--bg-tertiary);
      border-radius: 0 8px 8px 0;
      padding: 0.75rem 1rem;
    }

    .markdown-body hr {
      border: none;
      border-top: 1px solid var(--border);
      margin: 2rem 0;
    }

    .markdown-body ul ul, .markdown-body ol ol, .markdown-body ul ol, .markdown-body ol ul {
      margin-top: 0.3rem;
      margin-bottom: 0.3rem;
    }

    .markdown-body li > strong:first-child {
      color: var(--accent);
    }

    /* highlight.js theme overrides for app consistency */
    .hljs { background: var(--code-bg) !important; color: var(--text-primary); }

    /* Enhanced Table Styles */
    .markdown-body table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin: 2.5rem 0;
      border: 1px solid var(--border);
      border-radius: 14px;
      overflow: hidden;
      background: var(--bg-secondary);
    }

    .markdown-body th {
      background: var(--code-header);
      color: var(--highlight);
      font-weight: 700;
      text-align: left;
      padding: 0.75rem 1.25rem;
      border-bottom: 1px solid var(--border);
      font-size: 0.8125rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .markdown-body td {
      padding: 0.75rem 1.25rem;
      border-bottom: 1px solid var(--border);
      font-size: 0.9375rem;
      color: var(--text-primary);
    }

    @media (max-width: 640px) {
      .markdown-body th {
        font-size: 0.75rem;
        padding: 0.625rem 1rem;
      }
      .markdown-body td {
        font-size: 0.875rem;
        padding: 0.625rem 1rem;
      }
    }

    /* Technical Output Formatting */
    .markdown-body pre {
      background-color: var(--code-bg) !important;
      border: 1px solid var(--border);
      border-radius: 16px;
      min-width: -webkit-fill-available; /* Samsung Internet fallback */
      min-width: fit-content;
      padding: 0 !important;
      overflow-x: auto;
      max-width: 100%;
      display: block;
      box-shadow: 0 10px 30px -10px rgba(0,0,0,0.15);
    }

      /* meta[name=theme-color] is not supported by Firefox, Firefox for Android, Opera */
      /* script[type=importmap] is not supported by Safari on iOS < 16.4 */

    .markdown-body code {
      font-family: 'JetBrains Mono', Menlo, Consolas, 'Courier New', monospace;
      font-size: 0.875rem;
      font-variant-ligatures: normal;
      -webkit-font-smoothing: auto;
    }

    @media (max-width: 640px) {
      .markdown-body code {
        font-size: 0.8125rem;
      }
    }

    .markdown-body pre code {
      white-space: pre;
      word-wrap: normal;
      display: block;
      min-width: -webkit-fill-available; /* Samsung Internet fallback */
      min-width: fit-content;
      color: var(--text-primary);
    }

    /* Prevent oversized content from breaking layout on small screens */
    .markdown-body img, .markdown-body video, .markdown-body iframe {
      max-width: 100%;
      height: auto;
    }

    .markdown-body :not(pre) > code {
      background: var(--bg-tertiary);
      color: var(--accent);
      padding: 0.15em 0.4em;
      border-radius: 5px;
      font-size: 0.875em;
      font-weight: 600;
      border: 1px solid var(--border);
    }

    @media (max-width: 640px) {
      .markdown-body :not(pre) > code {
        font-size: 0.8125em;
      }
    }

    ::-webkit-scrollbar { width: 5px; height: 5px; }
    ::-webkit-scrollbar-thumb { background: var(--text-secondary); opacity: 0.3; border-radius: 10px; }
    ::-webkit-scrollbar-track { background: transparent; }
    
    .glass { background: var(--header-bg); -webkit-backdrop-filter: blur(25px); backdrop-filter: blur(25px); border-bottom: 1px solid var(--border); }
    .sidebar-transition { transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), width 0.3s cubic-bezier(0.4, 0, 0.2, 1); }

    @keyframes thought-pulse {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.1); }
    }
    .thought-dot { animation: thought-pulse 1.5s infinite ease-in-out; }

    /* Universal Caret Visibility */
    textarea, input {
      caret-color: var(--accent) !important;
    }
    
    /* NEW: Global layout fix for horizontal jitter */
    html, body, #root {
      overflow-x: hidden;
      width: 100%;
      position: relative;
    }

    /* Performance: GPU-accelerated sidebar transition */
    .sidebar-transition {
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      /* CLS fix: reserve sidebar width to prevent layout shift */
      contain: layout style;
    }

    /* Smooth touch interactions */
    button, a, [role="button"], input, textarea, select {
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    /* GPU-accelerate sidebar only */
    .sidebar-transition {
      will-change: transform;
    }

    /* Optimize scrolling containers */
    .overflow-y-auto, .overflow-x-auto, .overflow-auto {
      -webkit-overflow-scrolling: touch;
    }

    /* INP fix: off-screen messages skip rendering work */
    .gap-12 > div {
      content-visibility: auto;
      contain-intrinsic-size: auto 120px;
    }

    /* CLS fix: header has fixed height */
    header.glass {
      min-height: 56px;
    }
    @media (min-width: 640px) {
      header.glass { min-height: 64px; }
    }

    /* Safe area insets for iOS notch/home indicator */
    .pb-safe { padding-bottom: env(safe-area-inset-bottom, 0px); }
    .pt-safe { padding-top: env(safe-area-inset-top, 0px); }
  </style>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.34.0",
    "@supabase/supabase-js": "https://esm.sh/@supabase/supabase-js@^2.39.0",
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "remark-gfm": "https://esm.sh/remark-gfm@^4.0.1",
    "react-markdown": "https://esm.sh/react-markdown@^10.1.0",
    "@stripe/stripe-js": "https://esm.sh/@stripe/stripe-js@^3.0.0",
    "recharts": "https://esm.sh/recharts@^2.12.7",
    "mammoth": "https://esm.sh/mammoth@^1.6.0",
    "jszip": "https://esm.sh/jszip@^3.10.1",
    "xlsx": "https://esm.sh/xlsx@^0.18.5",
    "pdfjs-dist": "https://cdn.jsdelivr.net/npm/pdfjs-dist@4.4.168/+esm",
    "@/": "./"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
  <div id="root"></div>
<script type="module" src="/index.tsx"></script>
</body>
</html>
